import "./main.tsp";

using Azure.ClientGenerator.Core;
using Azure.Core.Experimental;

@clientNamespace("Azure.AI.Agents.Contracts.V2.Models")
namespace OpenAI {
  alias ItemResourceType = OutputItemType;
}

#suppress "@azure-tools/typespec-azure-core/experimental-feature" ""
@clientNamespace("Azure.AI.Agents.Contracts.V2.Models")
namespace Azure.AI.Projects {
  union _AdditionalToolTypes {
    remote_tool: "remote_tool",
  }
  @@copyVariants(OpenAI.ToolType, _AdditionalToolTypes);

  model RemoteToolArgument {
    /** The name of the remote tool. */
    name?: string;

    /** The description of the remote tool. */
    description?: string;

    /** The arguments for the remote tool. */
    arguments?: {
      connection_id?: string;
      knowledge_sources?: {
        connection_id?: string;
        query_parameters?: Record<string>;
        index_id?: string;
        index_connection_id?: string;
        index_details?: {
          index_configuration?: {
            index_name?: string;
          };
        };
        ...Record<unknown>;
      }[];
      ...Record<unknown>;
    };
  }

  model RemoteTool extends OpenAI.Tool {
    type: "remote_tool";
    tool_arguments?: RemoteToolArgument[];
  }

  union _AdditionalOutputItemTypes {
    remote_tool: "remote_tool",
    item_reference: "item_reference",
  }

  @@copyVariants(OpenAI.OutputItemType, _AdditionalOutputItemTypes);

  model OutputItemRemoteToolCall extends OpenAI.OutputItem {
    type: "remote_tool";

    /** The unique ID of the function tool call generated by the model. */
    call_id: string;

    /** The name of the function to run. */
    name: string;

    /** The label associated with the current object. */
    label: string;

    /** A JSON string of the arguments to pass to the function. */
    arguments: string;

    /**The status of the item. One of `in_progress`, `completed`, or
  `incomplete`. Populated when items are returned via API.*/
    #suppress "@azure-tools/typespec-azure-core/no-closed-literal-union" "Auto-suppressed warnings non-applicable rules during import."
    #suppress "@azure-tools/typespec-azure-core/no-unnamed-union" "Auto-suppressed warnings non-applicable rules during import."
    status?: "in_progress" | "completed" | "incomplete";
  }

  model OutputItemReference extends OpenAI.OutputItem {
    type: "item_reference";
  }

  union _AdditionalToolChoiceParamTypes {
    remote_tool: "remote_tool",
  }

  @@copyVariants(OpenAI.ToolChoiceParamType, _AdditionalToolChoiceParamTypes);

  model RemoteToolChoiceParam extends OpenAI.ToolChoiceParam {
    type: "remote_tool";

    /** Name of the tool in the remote tool server to use. */
    name: string;
  }

  @@copyProperties(OpenAI.CreateResponse,
    {
      rai_config?: string,
      internal_metadata?: {
        feature_flags?: string[],
        web_search?: {
          custom_search_config_id?: string,
          custom_search_resource_id?: string,
          ...Record<string>,
        },
        `user-context`?: {
          `request-ip`?: string,
          oid?: string,
          tid?: string,
          appid?: string,
          `auth-type`?: string,
          `token-type`?: string,
          upn?: string,
          `user-agent`?: string,
          `ms-user-agent`?: string,
          ...Record<string>,
        },
        `response-context`?: {
          `agent-name`?: string,
          `agent-version`?: string,
          `agent-version-id`?: string,
          `agent-kind`?: string,
          `conversation-id`?: string,
          `model`?: string,
          `top-p`?: string,
          temperature?: string,
          tools?: {
            `tool-name`?: string,
            `tool-type`?: string,
          }[],
          `reasoning-effort`?: string,
          `reasoning-summary`?: string,
          `max-tool-calls`?: integer,
          `parallel-tool-calls`?: boolean,
          `max-output-tokens`?: integer,
          `previous-response-id`?: string,
          `agent-version-created-at`?: utcDateTime,
          `agent-version-description`?: string,
          `hosted-agent-image`?: string,
          ...Record<string>,
        },
        `application-context`?: {
          `resource-id`?: string,
          `subscription-id`?: string,
          `tenant-id`?: string,
          region?: string,
          `creation-date`?: utcDateTime,
          `user-isolation-key`?: string,
          `chat-isolation-key`?: string,
          `application-id`?: string,
          ...Record<string>,
        },
        `defender-for-ai-context`?: {
          enabled?: boolean,
          ...Record<string>,
        },
        ...Record<string>,
      },
      resolved_agent_version?: AgentVersionObject,
    }
  );

  model InternalServiceMemorySearchTool extends MemorySearchTool {
    memory_store_id?: string;
    chat_summary_enabled?: boolean;
    user_profile_enabled?: boolean;
    user_profile_details?: string;
    chat_model?: string;
    embedding_model?: string;
  }

  // Propagate "id" to base of output items, not every union variant
  @@copyProperties(OpenAI.OutputItem,
    {
      id?: string,
    }
  );

  // Similarly, propagate "sequence_number" to base of stream events
  @@copyProperties(OpenAI.ResponseStreamEvent,
    {
      sequence_number: integer,
    }
  );

  // To allow in/out use of merged conversation message item, make id and status optional
  @@withoutOmittedProperties(OpenAI.Message, "id" | "status");
  @@copyProperties(OpenAI.Message,
    {
      id?: string,
      status?: OpenAI.MessageStatus,
    }
  );

  // To avoid conflicts with Azure.Response
  @@clientName(OpenAI.Response, "ResponseObject");

  // Remove created_by from specific models to avoid and facilitate base union
  @@withoutOmittedProperties(OpenAI.OutputItemFunctionShellCallOutput,
    "created_by"
  );
  @@withoutOmittedProperties(OpenAI.OutputItemFunctionShellCall, "created_by");
  @@withoutOmittedProperties(OpenAI.OutputItemCompactionBody, "created_by");
  @@withoutOmittedProperties(OpenAI.OutputItemApplyPatchToolCallOutput,
    "created_by"
  );
  @@withoutOmittedProperties(OpenAI.OutputItemApplyPatchToolCall, "created_by");

  // Force appearance on some types to ensure they don't emit with strange "1" suffixes
  @@access(CreateAgentFromManifestRequest, Access.public);
  @@usage(CreateAgentFromManifestRequest, Usage.input);
  @@access(CreateAgentRequest, Access.public);
  @@usage(CreateAgentRequest, Usage.input);
  @@access(CreateAgentVersionFromManifestRequest, Access.public);
  @@usage(CreateAgentVersionFromManifestRequest, Usage.input);
  @@access(CreateAgentVersionRequest, Access.public);
  @@usage(CreateAgentVersionRequest, Usage.input);
  @@access(OpenAI.ReasoningEffort, Access.public);
  @@usage(OpenAI.ReasoningEffort, Usage.input);
  @@access(UpdateAgentFromManifestRequest, Access.public);
  @@usage(UpdateAgentFromManifestRequest, Usage.input);
  @@access(UpdateAgentRequest, Access.public);
  @@usage(UpdateAgentRequest, Usage.input);

  @@access(OpenAI.OutputItemCustomToolCallOutput, Access.public);
  @@usage(OpenAI.OutputItemCustomToolCallOutput, Usage.input | Usage.output);
}
